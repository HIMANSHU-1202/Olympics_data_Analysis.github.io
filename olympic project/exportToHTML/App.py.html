<html>
<head>
<title>App.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
App.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">streamlit </span><span class="s0">as </span><span class="s1">st</span>
<span class="s0">import </span><span class="s1">pandas </span><span class="s0">as </span><span class="s1">pd</span>
<span class="s0">import </span><span class="s1">preprocessor</span>
<span class="s0">import </span><span class="s1">helper</span>
<span class="s0">import </span><span class="s1">plotly.express </span><span class="s0">as </span><span class="s1">px</span>
<span class="s0">import </span><span class="s1">matplotlib.pyplot </span><span class="s0">as </span><span class="s1">plt</span>
<span class="s0">import </span><span class="s1">seaborn </span><span class="s0">as </span><span class="s1">sns</span>
<span class="s0">import </span><span class="s1">plotly.figure_factory </span><span class="s0">as </span><span class="s1">ff</span>

<span class="s1">df = pd.read_csv(</span><span class="s2">'athlete_events.csv'</span><span class="s1">)</span>
<span class="s1">region_df = pd.read_csv(</span><span class="s2">'noc_regions.csv'</span><span class="s1">)</span>

<span class="s1">df =preprocessor.prepocess(df</span><span class="s0">,</span><span class="s1">region_df)</span>

<span class="s1">st.sidebar.image(</span><span class="s2">'pngwing.com.png'</span><span class="s1">)</span>

<span class="s1">st.sidebar.title(</span><span class="s2">&quot;Olympics Analysis&quot;</span><span class="s1">)</span>

<span class="s1">user_menu = st.sidebar.radio(</span>
    <span class="s2">'Select an Option'</span><span class="s0">,</span>
    <span class="s1">(</span><span class="s2">'Medal Tally'</span><span class="s0">,</span><span class="s2">'Overall Analysis'</span><span class="s0">,</span><span class="s2">'Country-wise Analysis'</span><span class="s0">,</span><span class="s2">'Athlete-wise Analysis'</span><span class="s0">,</span><span class="s2">'athletes'</span><span class="s1">)</span>
<span class="s1">)</span>


<span class="s0">if </span><span class="s1">user_menu== </span><span class="s2">'Medal Tally'</span><span class="s1">:</span>
    <span class="s1">st.sidebar.header(</span><span class="s2">&quot;Medal Tally&quot;</span><span class="s1">)</span>
    <span class="s1">years</span><span class="s0">,</span><span class="s1">country=helper.country_year_list(df)</span>
    <span class="s1">selected_years=st.sidebar.selectbox(</span><span class="s2">&quot;Select Year&quot;</span><span class="s0">,</span><span class="s1">years)</span>
    <span class="s1">selected_country = st.sidebar.selectbox(</span><span class="s2">&quot;Select country&quot;</span><span class="s0">, </span><span class="s1">country)</span>
    <span class="s1">Medal_Tally =helper.fetch_Metal_Tally(df</span><span class="s0">,</span><span class="s1">selected_years</span><span class="s0">,</span><span class="s1">selected_country)</span>
    <span class="s0">if </span><span class="s1">selected_years == </span><span class="s2">'Overall' </span><span class="s0">and </span><span class="s1">selected_country ==</span><span class="s2">'Overall'</span><span class="s1">:</span>
        <span class="s1">st.title(</span><span class="s2">&quot;Overall Tally&quot;</span><span class="s1">)</span>
    <span class="s0">if </span><span class="s1">selected_years!=  </span><span class="s2">'Overall' </span><span class="s0">and </span><span class="s1">selected_country==</span><span class="s2">'Overall'</span><span class="s1">:</span>
        <span class="s1">st.title(</span><span class="s2">&quot;Medal Tally in &quot; </span><span class="s1">+ str(selected_years) + </span><span class="s2">&quot; Olympics&quot;</span><span class="s1">)</span>
    <span class="s0">if </span><span class="s1">selected_years==</span><span class="s2">'Overall' </span><span class="s0">and </span><span class="s1">selected_country!=</span><span class="s2">'Overall'</span><span class="s1">:</span>
        <span class="s1">st.title(selected_country + </span><span class="s2">&quot; overall performance&quot;</span><span class="s1">)</span>
    <span class="s0">if </span><span class="s1">selected_years!=</span><span class="s2">'Overall'</span><span class="s0">and </span><span class="s1">selected_country!=</span><span class="s2">'Overall'</span><span class="s1">:</span>
        <span class="s1">st.title(selected_country+ </span><span class="s2">&quot; performance in &quot; </span><span class="s1">+ str(selected_years))</span>

    <span class="s1">st.table(Medal_Tally)</span>
<span class="s0">if </span><span class="s1">user_menu == </span><span class="s2">'Overall Analysis'</span><span class="s1">:</span>
    <span class="s1">editions = df[</span><span class="s2">'Year'</span><span class="s1">].unique().shape[</span><span class="s3">0</span><span class="s1">]-</span><span class="s3">3</span>
    <span class="s1">cities = df[</span><span class="s2">'City'</span><span class="s1">].unique().shape[</span><span class="s3">0</span><span class="s1">]</span>
    <span class="s1">sports = df[</span><span class="s2">'Sport'</span><span class="s1">].unique().shape[</span><span class="s3">0</span><span class="s1">]</span>
    <span class="s1">events = df[</span><span class="s2">'Event'</span><span class="s1">].unique().shape[</span><span class="s3">0</span><span class="s1">]</span>
    <span class="s1">athletes = df[</span><span class="s2">'Name'</span><span class="s1">].unique().shape[</span><span class="s3">0</span><span class="s1">]</span>
    <span class="s1">nations = df[</span><span class="s2">'region'</span><span class="s1">].unique().shape[</span><span class="s3">0</span><span class="s1">]</span>

    <span class="s1">col1</span><span class="s0">,</span><span class="s1">col2</span><span class="s0">,</span><span class="s1">col3 = st.columns(</span><span class="s3">3</span><span class="s1">)</span>
    <span class="s0">with </span><span class="s1">col1:</span>
        <span class="s1">st.header(</span><span class="s2">&quot;Editions&quot;</span><span class="s1">)</span>
        <span class="s1">st.title(editions)</span>
    <span class="s0">with </span><span class="s1">col2 :</span>
        <span class="s1">st.header(</span><span class="s2">&quot;Hosts&quot;</span><span class="s1">)</span>
        <span class="s1">st.title(cities)</span>
    <span class="s0">with </span><span class="s1">col3:</span>
        <span class="s1">st.header(</span><span class="s2">&quot;Sports&quot;</span><span class="s1">)</span>
        <span class="s1">st.title(sports)</span>

    <span class="s1">col1</span><span class="s0">, </span><span class="s1">col2</span><span class="s0">, </span><span class="s1">col3 = st.columns(</span><span class="s3">3</span><span class="s1">)</span>
    <span class="s0">with </span><span class="s1">col1:</span>
        <span class="s1">st.header(</span><span class="s2">&quot;Events&quot;</span><span class="s1">)</span>
        <span class="s1">st.title(events)</span>
    <span class="s0">with </span><span class="s1">col2:</span>
        <span class="s1">st.header(</span><span class="s2">&quot;Athletes&quot;</span><span class="s1">)</span>
        <span class="s1">st.title(athletes)</span>
    <span class="s0">with </span><span class="s1">col3:</span>
        <span class="s1">st.header(</span><span class="s2">&quot;Nations&quot;</span><span class="s1">)</span>
        <span class="s1">st.title(nations)</span>


    <span class="s1">event_over_time = helper.data_over_time(df</span><span class="s0">, </span><span class="s2">'Event'</span><span class="s1">)</span>
    <span class="s1">fig = px.line(event_over_time</span><span class="s0">, </span><span class="s1">x=</span><span class="s2">'Edition'</span><span class="s0">, </span><span class="s1">y=</span><span class="s2">'Event'</span><span class="s1">)</span>
    <span class="s1">st.title(</span><span class="s2">' Events Over Years '</span><span class="s1">)</span>
    <span class="s1">st.plotly_chart(fig)</span>

    <span class="s1">athletes_over_time = helper.data_over_time(df</span><span class="s0">, </span><span class="s2">'Name'</span><span class="s1">)</span>
    <span class="s1">fig = px.line(athletes_over_time</span><span class="s0">, </span><span class="s1">x=</span><span class="s2">'Edition'</span><span class="s0">, </span><span class="s1">y=</span><span class="s2">'Name'</span><span class="s1">)</span>
    <span class="s1">st.title(</span><span class="s2">' Athletes Over Years '</span><span class="s1">)</span>
    <span class="s1">st.plotly_chart(fig)</span>

    <span class="s1">nation_over_time = helper.data_over_time(df</span><span class="s0">, </span><span class="s2">'region'</span><span class="s1">)</span>
    <span class="s1">fig = px.line(nation_over_time</span><span class="s0">, </span><span class="s1">x=</span><span class="s2">'Edition'</span><span class="s0">, </span><span class="s1">y=</span><span class="s2">'region'</span><span class="s1">)</span>
    <span class="s1">st.title(</span><span class="s2">' Participating Nations Over Years '</span><span class="s1">)</span>
    <span class="s1">st.plotly_chart(fig)</span>

    <span class="s1">st.title(</span><span class="s2">&quot;Numbers Of Events Over Time (Every Sport) &quot;</span><span class="s1">)</span>
    <span class="s1">fig</span><span class="s0">,</span><span class="s1">ax = plt.subplots(figsize=(</span><span class="s3">20</span><span class="s0">,</span><span class="s3">20</span><span class="s1">))</span>
    <span class="s1">x = df.drop_duplicates([</span><span class="s2">'Year'</span><span class="s0">, </span><span class="s2">'Sport'</span><span class="s0">, </span><span class="s2">'Event'</span><span class="s1">])</span>
    <span class="s1">ax = sns.heatmap(x.pivot_table(index=</span><span class="s2">'Sport'</span><span class="s0">, </span><span class="s1">columns=</span><span class="s2">'Year'</span><span class="s0">, </span><span class="s1">values=</span><span class="s2">'Event'</span><span class="s0">, </span><span class="s1">aggfunc=</span><span class="s2">'count'</span><span class="s1">).fillna(</span><span class="s3">0</span><span class="s1">).astype((</span><span class="s2">'int'</span><span class="s1">))</span><span class="s0">, </span><span class="s1">annot=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">st.pyplot(fig)</span>

    <span class="s1">st.title(</span><span class="s2">&quot;Most Successful Athletes&quot;</span><span class="s1">)</span>
    <span class="s1">sport_list= df[</span><span class="s2">'Sport'</span><span class="s1">].unique().tolist()</span>
    <span class="s1">sport_list.sort()</span>
    <span class="s1">sport_list.insert(</span><span class="s3">0</span><span class="s0">,</span><span class="s2">'Overall'</span><span class="s1">)</span>

    <span class="s1">selected_sport = st.selectbox(</span><span class="s2">'Selecta sport'</span><span class="s0">,</span><span class="s1">sport_list)</span>
    <span class="s1">x=helper.most_sucessful(df</span><span class="s0">,</span><span class="s1">selected_sport)</span>
    <span class="s1">st.table(x)</span>

<span class="s0">if </span><span class="s1">user_menu == </span><span class="s2">'Country-wise Analysis'</span><span class="s1">:</span>

    <span class="s1">st.sidebar.title(</span><span class="s2">'Country-wise Analysis'</span><span class="s1">)</span>
    <span class="s1">country_list = df[</span><span class="s2">'region'</span><span class="s1">].dropna().unique().tolist()</span>
    <span class="s1">country_list.sort()</span>

    <span class="s1">select_country = st.sidebar.selectbox(</span><span class="s2">'Select a Country '</span><span class="s0">, </span><span class="s1">country_list)</span>

    <span class="s1">country_df = helper.yearwise_medal_tally(df</span><span class="s0">,</span><span class="s1">select_country)</span>
    <span class="s1">fig = px.line(country_df</span><span class="s0">,</span><span class="s1">x=</span><span class="s2">'Year'</span><span class="s0">,</span><span class="s1">y=</span><span class="s2">'Medal'</span><span class="s1">)</span>

    <span class="s1">st.title(select_country+ </span><span class="s2">&quot; Medal Tally Over Year&quot;</span><span class="s1">)</span>
    <span class="s1">st.plotly_chart(fig)</span>
    <span class="s1">st.title(select_country + </span><span class="s2">&quot; Excels in Following Sport&quot;</span><span class="s1">)</span>
    <span class="s1">pt= helper.country_event_heatmap(df</span><span class="s0">,</span><span class="s1">select_country)</span>

    <span class="s1">fig</span><span class="s0">, </span><span class="s1">ax = plt.subplots(figsize=(</span><span class="s3">20</span><span class="s0">, </span><span class="s3">20</span><span class="s1">))</span>
    <span class="s1">ax = sns.heatmap(pt</span><span class="s0">,</span><span class="s1">annot =</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">st.pyplot(fig)</span>

    <span class="s1">st.title(</span><span class="s2">&quot; Top 10 Athlete of &quot;</span><span class="s1">+ select_country)</span>
    <span class="s1">top10_df=helper.most_sucessful_countrywise(df</span><span class="s0">,</span><span class="s1">select_country)</span>
    <span class="s1">st.table(top10_df)</span>

<span class="s0">if </span><span class="s1">user_menu == </span><span class="s2">'Athlete-wise Analysis'</span><span class="s1">:</span>
    <span class="s1">athlete_df = df.drop_duplicates(subset=[</span><span class="s2">'Name'</span><span class="s0">, </span><span class="s2">'region'</span><span class="s1">])</span>

    <span class="s1">x1 = athlete_df[</span><span class="s2">'Age'</span><span class="s1">].dropna()</span>
    <span class="s1">x2 = athlete_df[athlete_df[</span><span class="s2">'Medal'</span><span class="s1">] == </span><span class="s2">'Gold'</span><span class="s1">][</span><span class="s2">'Age'</span><span class="s1">].dropna()</span>
    <span class="s1">x3 = athlete_df[athlete_df[</span><span class="s2">'Medal'</span><span class="s1">] == </span><span class="s2">'Silver'</span><span class="s1">][</span><span class="s2">'Age'</span><span class="s1">].dropna()</span>
    <span class="s1">x4 = athlete_df[athlete_df[</span><span class="s2">'Medal'</span><span class="s1">] == </span><span class="s2">'Bronze'</span><span class="s1">][</span><span class="s2">'Age'</span><span class="s1">].dropna()</span>

    <span class="s1">fig = ff.create_distplot([x1</span><span class="s0">, </span><span class="s1">x2</span><span class="s0">, </span><span class="s1">x3</span><span class="s0">, </span><span class="s1">x4]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">'Overall Age'</span><span class="s0">, </span><span class="s2">'Gold Medalist'</span><span class="s0">, </span><span class="s2">'Silver Medalist'</span><span class="s0">, </span><span class="s2">'Bronze Medalist'</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">show_hist=</span><span class="s0">False, </span><span class="s1">show_rug=</span><span class="s0">False</span><span class="s1">)</span>

    <span class="s1">st.title(</span><span class="s2">&quot;Athletes Information &quot;</span><span class="s1">)</span>

    <span class="s1">select_athletes = df[</span><span class="s2">'Name'</span><span class="s1">].unique().tolist()</span>
    <span class="s1">select_athletes.insert(</span><span class="s3">0</span><span class="s0">, </span><span class="s2">'Overall'</span><span class="s1">)</span>
    <span class="s1">select_athletes.sort()</span>
    <span class="s1">selected_athletes = st.selectbox(</span><span class="s2">'select atheletes'</span><span class="s0">, </span><span class="s1">select_athletes)</span>
    <span class="s1">x = helper.filter_by_name(df</span><span class="s0">, </span><span class="s1">selected_athletes)</span>
    <span class="s1">st.table(x)</span>

    <span class="s1">st.title(</span><span class="s2">&quot;Distribution of Age &quot;</span><span class="s1">)</span>
    <span class="s1">st.plotly_chart(fig)</span>

    <span class="s1">x = []</span>
    <span class="s1">name = []</span>
    <span class="s1">famous_sports = [</span><span class="s2">'Basketball'</span><span class="s0">, </span><span class="s2">'Judo'</span><span class="s0">, </span><span class="s2">'Football'</span><span class="s0">, </span><span class="s2">'Tug-Of-War'</span><span class="s0">,</span>
                     <span class="s2">'Athletics'</span><span class="s0">, </span><span class="s2">'Swimming'</span><span class="s0">,</span>
                     <span class="s2">'Badminton'</span><span class="s0">, </span><span class="s2">'Sailing'</span><span class="s0">, </span><span class="s2">'Gymnastics'</span><span class="s0">,</span>
                     <span class="s2">'Art Competitions'</span><span class="s0">, </span><span class="s2">'Handball'</span><span class="s0">, </span><span class="s2">'Weightlifting'</span><span class="s0">,</span>
                     <span class="s2">'Wrestling'</span><span class="s0">, </span><span class="s2">'Water Polo'</span><span class="s0">, </span><span class="s2">'Hockey'</span><span class="s0">, </span><span class="s2">'Rowing'</span><span class="s0">,</span>
                     <span class="s2">'Fencing'</span><span class="s0">, </span><span class="s2">'Shooting'</span><span class="s0">, </span><span class="s2">'Boxing'</span><span class="s0">, </span><span class="s2">'Taekwondo'</span><span class="s0">,</span>
                     <span class="s2">'Cycling'</span><span class="s0">, </span><span class="s2">'Diving'</span><span class="s0">, </span><span class="s2">'Canoeing'</span><span class="s0">, </span><span class="s2">'Tennis'</span><span class="s0">,</span>
                     <span class="s2">'Golf'</span><span class="s0">, </span><span class="s2">'Softball'</span><span class="s0">, </span><span class="s2">'Archery'</span><span class="s0">, </span><span class="s2">'Volleyball'</span><span class="s0">,</span>
                     <span class="s2">'Synchronized Swimming'</span><span class="s0">, </span><span class="s2">'Table Tennis'</span><span class="s0">,</span>
                     <span class="s2">'Baseball'</span><span class="s0">, </span><span class="s2">'Rhythmic Gymnastics'</span><span class="s0">,</span>
                     <span class="s2">'Rugby Sevens'</span><span class="s0">, </span><span class="s2">'Beach Volleyball'</span><span class="s0">, </span><span class="s2">'Triathlon'</span><span class="s0">,</span>
                     <span class="s2">'Rugby'</span><span class="s0">,</span>
                     <span class="s2">'Polo'</span><span class="s0">, </span><span class="s2">'Ice Hockey'</span>
                     <span class="s1">]</span>
    <span class="s0">for </span><span class="s1">sport </span><span class="s0">in </span><span class="s1">famous_sports:</span>
        <span class="s1">temp_df = athlete_df[athlete_df[</span><span class="s2">'Sport'</span><span class="s1">] == sport]</span>
        <span class="s1">x.append(temp_df[temp_df[</span><span class="s2">'Medal'</span><span class="s1">] == </span><span class="s2">'Gold'</span><span class="s1">][</span><span class="s2">'Age'</span><span class="s1">].dropna())</span>
        <span class="s1">name.append(sport)</span>

    <span class="s1">fig = ff.create_distplot(x</span><span class="s0">, </span><span class="s1">name</span><span class="s0">, </span><span class="s1">show_hist=</span><span class="s0">False, </span><span class="s1">show_rug=</span><span class="s0">False</span><span class="s1">)</span>

    <span class="s1">st.title(</span><span class="s2">&quot;Distribution of Age with respect to Sports (Gold Medalist&quot;</span><span class="s1">)</span>
    <span class="s1">st.plotly_chart(fig)</span>

    <span class="s1">sport_list = df[</span><span class="s2">'Sport'</span><span class="s1">].unique().tolist()</span>
    <span class="s1">sport_list.sort()</span>
    <span class="s1">sport_list.insert(</span><span class="s3">0</span><span class="s0">, </span><span class="s2">'Overall'</span><span class="s1">)</span>
    <span class="s1">st.title(</span><span class="s2">&quot;Height Vs Weight&quot;</span><span class="s1">)</span>
    <span class="s1">selected_sport =st.selectbox(</span><span class="s2">&quot;Select Sport &quot;</span><span class="s0">, </span><span class="s1">sport_list)</span>
    <span class="s1">temp_df=helper.weight_v_height(df</span><span class="s0">,</span><span class="s1">selected_sport)</span>
    <span class="s1">fig</span><span class="s0">,</span><span class="s1">ax =plt.subplots()</span>
    <span class="s1">ax= sns.scatterplot(temp_df[</span><span class="s2">'Weight'</span><span class="s1">]</span><span class="s0">,</span><span class="s1">temp_df[</span><span class="s2">'Height'</span><span class="s1">]</span><span class="s0">,</span><span class="s1">hue=temp_df[</span><span class="s2">'Medal'</span><span class="s1">]</span><span class="s0">,</span><span class="s1">style=temp_df[</span><span class="s2">'Sex'</span><span class="s1">])</span>

    <span class="s1">st.pyplot(fig)</span>

    <span class="s1">st.title(</span><span class="s2">&quot;Men Vs Women Participation Over the Years&quot;</span><span class="s1">)</span>
    <span class="s1">final=helper.men_vs_women(df)</span>
    <span class="s1">fig = px.line(final</span><span class="s0">, </span><span class="s1">x=</span><span class="s2">'Year'</span><span class="s0">, </span><span class="s1">y=[</span><span class="s2">&quot;Male&quot;</span><span class="s0">,</span><span class="s2">&quot;Female&quot;</span><span class="s1">])</span>
    <span class="s1">st.plotly_chart(fig)</span>

</pre>
</body>
</html>